/**@license
 * LIPS is Pretty Simple - version DEV
 *
 * Copyright (c) 2018 Jakub Jankiewicz <http://jcubic.pl/me>
 * Released under the MIT license
 *
 * build: Fri, 14 Sep 2018 20:53:39 +0000
 */
"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _asyncToGenerator(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,r){function t(i,a){try{var u=n[i](a);var o=u.value}catch(e){r(e);return}if(u.done){e(o)}else{return Promise.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)})}}return t("next")})}}function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,r=Array(e.length);n<e.length;n++){r[n]=e[n]}return r}else{return Array.from(e)}}(function(e,n){if(typeof define==="function"&&define.amd){define(["bn.js"],function(r){return e.lips=n(e,r)})}else if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&module.exports){module.exports=n(e,require("bn.js"))}else{e.lips=n(e,e.BN)}})(typeof window!=="undefined"?window:global,function(e,n,r){var t=/^\/((?:\\\/|[^/]|\[[^\]]*\/[^\]]*\])+)\/([gimy]*)$/;var i=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/;function a(e){function n(e){if(e.match(/^['"]/)){if(e==='""'||e==="''"){return""}var n=e[0];var r=new RegExp("((^|[^\\\\])(?:\\\\\\\\)*)"+n,"g");e=e.replace(r,"$1")}return JSON.parse('"'+e+'"')}var r=e.match(t);if(r){return new RegExp(r[1],r[2])}else if(e.match(/['"]/)){return n(e)}else if(e.match(/^-?[0-9]+$/)){return w(parseInt(e,10))}else if(e.match(i)){return w(parseFloat(e))}else if(e==="nil"){return p}else{return new h(e)}}var u=/("[^"\\]*(?:\\[\S\s][^"\\]*)*"|\/[^\/\\]*(?:\\[\S\s][^\/\\]*)*\/[gimy]*(?=\s|\(|\)|$)|;.*|\(|\)|'|\.|,@|,|`|[^(\s)]+)/gi;function o(e,n){if(n){return f(e)}else{return f(e).map(function(e){return e.token.trim()}).filter(function(e){return e&&!e.match(/^;/)})}}function f(e){var n=0;return e.split("\n").map(function(e,r){var t=0;n+=r===0?0:1;return e.split(u).filter(Boolean).map(function(e){var i={col:t,line:r,token:e,offset:n};t+=e.length;n+=e.length;return i})}).reduce(function(e,n){return e.concat(n)},[])}var c={"'":new h("quote"),"`":new h("quasiquote"),",":new h("unquote"),",@":new h("unquote-splicing")};function s(e){var n=[];var r=[];var t=null;var i=Object.keys(c);var u=i.map(function(e){return c[e].name});var o=0;var f=false;var s=[];var l=[];function v(){var e=n[n.length-1];if(e instanceof Array&&e[0]instanceof h&&u.includes(e[0].name)&&n.length>1){n.pop();if(n[n.length-1].length===1&&n[n.length-1][0]instanceof h){n[n.length-1].push(e)}else if(n[n.length-1].length===0){n[n.length-1]=e}else if(n[n.length-1]instanceof d){if(n[n.length-1].cdr instanceof d){n[n.length-1]=new d(n[n.length-1],d.fromArray(e))}else{n[n.length-1].cdr=d.fromArray(e)}}else{n[n.length-1].push(e)}}}e.forEach(function(e){var u=n[n.length-1];if(i.indexOf(e)!==-1){t=e;n.push([c[t]]);if(!t){l=[]}l.push(t)}else if(e==="("){f=true;o++;if(t){s.push(l);l=[]}n.push([]);t=null}else if(e==="."&&!f){n[n.length-1]=d.fromArray(u)}else if(e===")"){o--;if(!n.length){throw new Error("Unbalanced parenthesis 1")}if(n.length===1){r.push(n.pop())}else if(n.length>1){var h=n.pop();u=n[n.length-1];if(u instanceof Array){u.push(h)}else if(u instanceof d){u.append(d.fromArray(h))}if(s.length){l=s.pop();while(l.length){v();l.pop()}}else{v()}}if(o===0&&n.length){r.push(n.pop())}}else{f=false;var y=a(e);if(t){n[n.length-1][1]=y;y=n.pop();t=false}u=n[n.length-1];if(u instanceof d){var w=u;while(true){if(w.cdr===p){if(y instanceof Array){w.cdr=d.fromArray(y)}else{w.cdr=y}break}else{w=w.cdr}}}else if(!n.length){r.push(y)}else{u.push(y)}}});if(n.length){console.log({end:n.slice()});throw new Error("Unbalanced parenthesis 2")}return r.map(function(e){if(e instanceof Array){return d.fromArray(e)}return e})}function l(e,n){var t=Object.prototype.toString;var i="[object Array]";var a=[];var u=n&&e||e.slice();var o;if(!e.length){return a}o=u.pop();do{if(t.call(o)===i){u.push.apply(u,o)}else{a.push(o)}}while(u.length&&(o=u.pop())!==r);a.reverse();return a}function h(e){this.name=e}h.is=function(e,n){return e instanceof h&&typeof n==="string"&&e.name===n};h.prototype.toJSON=h.prototype.toString=function(){return this.name};function v(){}v.prototype.toString=function(){return"nil"};var p=new v;function d(e,n){this.car=e;this.cdr=n}d.prototype.flatten=function(){return d.fromArray(l(this.toArray()))};d.prototype.length=function(){var e=0;var n=this;while(true){if(n===p){break}e++;n=n.cdr}return e};d.prototype.clone=function(){var e=this.cdr;var n=this.car;if(n instanceof d){n=n.clone()}if(e instanceof d){e=this.cdr.clone()}return new d(n,e)};d.prototype.toArray=function(){if(this.cdr===p&&this.car===p){return[]}var e=[];if(this.car instanceof d){e.push(this.car.toArray())}else{e.push(this.car)}if(this.cdr instanceof d){e=e.concat(this.cdr.toArray())}return e};d.prototype.isEmptyList=function(){return typeof this.car==="undefined"&&this.cdr===p};d.fromArray=function(e){if(e instanceof d){return e}if(e.length&&!e instanceof Array){e=[].concat(_toConsumableArray(e))}if(e.length===0){return new d(r,p)}else{var n;if(e[0]instanceof Array){n=d.fromArray(e[0])}else{n=e[0]}if(e.length===1){return new d(n,p)}else{return new d(n,d.fromArray(e.slice(1)))}}};d.prototype.toObject=function(){var e=this;var n={};while(true){if(e instanceof d&&e.car instanceof d){var r=e.car;var t=r.car;if(t instanceof h){t=t.name}n[t]=r.cdr;e=e.cdr}else{break}}return n};d.fromPairs=function(e){return e.reduce(function(e,n){return new d(new d(new h(n[0]),n[1]),e)},p)};d.fromObject=function(e){var n=Object.keys(e).map(function(n){return[n,e[n]]});return d.fromPairs(n)};d.prototype.reduce=function(e){var n=this;var r=p;while(true){if(n!==p){r=e(r,n.car);n=n.cdr}else{break}}return r};d.prototype.reverse=function(){var e=this;var n=p;while(e!==p){var r=e.cdr;e.cdr=n;n=e;e=r}return n};d.prototype.transform=function(e){var n=[];function r(t){if(t instanceof d){if(t.replace){delete t.replace;return t}var i=e(t.car);if(i instanceof d){i=r(i);n.push(i)}var a=e(t.cdr);if(a instanceof d){a=r(a);n.push(a)}return new d(i,a)}return t}return r(this)};d.prototype.toString=function(){var e=["("];if(this.car!==r){if(typeof this.car==="function"){e.push("<#function "+(this.car.name||"anonymous")+">")}else if(typeof this.car==="string"){e.push(JSON.stringify(this.car))}else if(typeof this.car!=="undefined"){e.push(this.car)}if(this.cdr instanceof d){e.push(" ");e.push(this.cdr.toString().replace(/^\(|\)$/g,""))}else if(typeof this.cdr!=="undefined"&&this.cdr!==p){if(typeof this.cdr==="string"){e=e.concat([" . ",JSON.stringify(this.cdr)])}else{e=e.concat([" . ",this.cdr])}}}e.push(")");return e.join("")};d.prototype.append=function(e){if(e instanceof Array){return this.append(d.fromArray(e))}var n=this;if(n.car===r){if(e instanceof d){this.car=e.car;this.cdr=e.cdr}else{return e}}else{while(true){if(n instanceof d&&n.cdr!==p){n=n.cdr}else{break}}n.cdr=e}return this};function y(e,n){this.name=e;this.fn=n}y.prototype.invoke=function(e,n,r,t){return this.fn.call(r,n,t,e)};y.prototype.toString=function(){return"#<Macro "+this.name+">"};function w(e){if(e instanceof w){return e}if(typeof this!=="undefined"&&this.constructor!==w||typeof this==="undefined"){return new w(e)}if(!w.isNumber(e)){throw new Error("You can't create LNumber from "+(typeof e==="undefined"?"undefined":_typeof(e)))}if(e===null){e=0}if(w.isFloat(e)){this.value=e}else if(typeof BigInt!=="undefined"){if(typeof e!=="bigint"){this.value=BigInt(e)}else{this.value=e}}else if(typeof n!=="undefined"&&!(e instanceof n)){this.value=new n(e)}else{this.value=e}}w.isFloat=function e(n){return Number(n)===n&&n%1!==0};w.isNumber=function(e){return e instanceof w||w.isNative(e)||w.isBN(e)};w.isNative=function(e){return typeof e==="bigint"||typeof e==="number"};w.isBN=function(e){return typeof n!=="undefined"&&e instanceof n};w.prototype.toString=function(){return this.value.toString()};w.prototype.valueOf=function(){if(w.isNative(this.value)){return Number(this.value)}else if(w.isBN(this.value)){return this.value.toNumber()}};w.prototype.coerce=function(e){if(e===null){e=0}var r;if(e instanceof w){r=e.value}else{r=e}if(w.isFloat(r)){}else if(typeof this.value==="bigint"&&typeof r!=="bigint"){r=BigInt(r)}else if(typeof n!=="undefined"&&this.value instanceof n&&!r instanceof n){r=new n(r)}return w(r)};w.prototype.add=function(e){e=this.coerce(e);if(w.isNative(e.value)){e.value=this.value+e.value}else if(w.isBN(this.value)){e.value.iadd(this.value)}return e};w.prototype.sub=function(e){e=this.coerce(e);if(w.isNative(e.value)){e.value=this.value-e.value}else if(w.isBN(this.value)){e.value.isub(this.value)}return e};w.prototype.mul=function(e){e=this.coerce(e);if(w.isNative(e.value)){e.value=this.value*e.value}else if(w.isBN(this.value)){e.value.imul(this.value)}return e};w.prototype.div=function(e){e=this.coerce(e);if(w.isNative(e.value)){e.value=this.value/e.value}else if(w.isBN(this.value)){e.value.idiv(this.value)}return e};w.prototype.mod=function(e){e=this.coerce(e);if(w.isNative(e.value)){e.value=this.value%e.value}else if(w.isBN(this.value)){e.value.imod(this.value)}return e};w.prototype.sqrt=function(){var e;if(w.isNative(this.value)){e=Math.sqrt(this.value)}else if(w.isBN(this.value)){e=this.value.sqrt()}return new w(e)};w.prototype.pow=function(e){e=this.coerce(e);if(w.isNative(this.value)){try{var n=new Function("a,b","return a**b;");e.value=n(this.value,e.value)}catch(e){throw new Error("Power operator not supported")}}else if(w.isBN(this.value)){e.value=this.value.pow(e.value)}else{e.value=Math.pow(this.value,e.value)}return e};w.prototype.neg=function(){var e=this.value;if(w.isNative(e)){e=-e}else if(w.isBN(e)){e=e.neg()}return new w(e)};w.prototype.abs=function(){var e=this.value;if(w.isNative(this.value)){if(e<0){e=-e}}else if(w.isBN(e)){e.iabs()}return new w(e)};w.prototype.isOdd=function(){if(w.isNative(this.value)){return this.value%2===1}else if(w.isBN(this.value)){return this.value.isOdd()}};w.prototype.isEven=function(){return!this.isOdd()};w.prototype.cmp=function(e){e=this.coerce(e);if(w.isNative(this.value)){if(this.value<e.value){return-1}else if(this.value===e.value){return 0}else{return 1}}else if(w.isBN(this.value)){return this.value.cmp(e.value)}};function m(e,n,r){this.env=e;this.parent=n;this.name=r}m.prototype.inherit=function(e,n){if(typeof e==="string"){n=e;e={}}if(!n){n="child of "+(this.name||"unknown")}return new m(e||{},this,n)};m.prototype.get=function(n){var r;if(n instanceof h){if(typeof this.env[n.name]!=="undefined"){r=this.env[n.name]}}else if(typeof n==="string"){if(typeof this.env[n]!=="undefined"){r=this.env[n]}}if(typeof r!=="undefined"){if(w.isNumber(r)){return w(r)}return r}if(this.parent instanceof m){return this.parent.get(n)}else{var t;if(n instanceof h){t=n.name}else if(typeof n==="string"){t=n}if(t){var i=_typeof(e[t]);if(i==="function"){return e[t].bind(e)}else if(i!=="undefined"){return e[t]}}}};m.prototype.set=function(e,n){if(w.isNumber(n)){n=w(n)}if(e instanceof h){e=e.name}this.env[e]=n};function g(e){this.value=e}function b(e,n){this.value=e;this.count=n}b.prototype.toString=function(){return"<#unquote["+this.count+"] "+this.value+">"};function A(e){var n="let"+(e?"*":"");return new y(n,function(n,r){var t=this;var i=this.get("list->array")(n.car);var a=this.inherit("let");return new Promise(function(u){var o=[];var f=0;(function c(){var s=i[f++];function l(e){if(e instanceof Promise){o.push(e);return e.then(l)}else{a.set(s.car,e)}}if(!s){var v=new d(new h("begin"),n.cdr);S(v,a,r?a:r).then(function(e){u(new g(e))})}else{var p=S(s.cdr.car,e?a:t,r);var y=l(p);if(y instanceof Promise){y.then(function(){Promise.all(o).then(c)})}else{c()}}})()})})}var N=function(){var e=0;return function(){e++;return new h("#"+e)}}();function E(e){var n=arguments.length>1&&arguments[1]!==r?arguments[1]:"GET";var t=arguments.length>2&&arguments[2]!==r?arguments[2]:{};var i=arguments.length>3&&arguments[3]!==r?arguments[3]:null;var a=new XMLHttpRequest;a.open(n,e,true);Object.keys(t).forEach(function(e){a.setRequestHeader(e,t[e])});return new Promise(function(e){a.onreadystatechange=function(){if(a.readyState===4&&a.status===200){e(a.responseText)}};if(i!==null){a.send(i)}else{a.send()}})}var k=new m({nil:p,true:true,false:false,stdout:{write:function e(){var n;(n=console).log.apply(n,arguments)}},stdin:{read:function e(){return new Promise(function(e){e(prompt(""))})}},test:function e(){return Promise.resolve(r)},cons:function e(n,r){return new d(n,r)},car:function e(n){if(n instanceof d){return n.car}else{throw new Error("argument to car need to be a list")}},cdr:function e(n){if(n instanceof d){return n.cdr}else{throw new Error("argument to cdr need to be a list")}},set:new y("set",function(e,n){var r;if(e.cdr.car instanceof d){if(n){n=this}r=S(e.cdr.car,this,n)}else{r=e.cdr.car}this.set(e.car,r)}),"set-car":function e(n,r){n.car=r},"set-cdr":function e(n,r){n.cdr=r},assoc:function e(n,r){var t=n;var i=r instanceof h?r.name:r;while(true){var a=t.car.car;if(a instanceof h&&a.name===i||a.name===i){return t.car}else{t=t.cdr}}},gensym:N,load:function e(n){var r=this;E(n).then(function(e){r.get("eval")(r.get("read")(e))})},while:new y("while",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(n,r){var t,i,a,u;return regeneratorRuntime.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:t=this;i=new d(new h("begin"),n.cdr);if(r){r=t}case 3:if(!true){o.next=16;break}o.next=6;return S(n.car,t,r);case 6:u=o.sent;if(!u){o.next=13;break}o.next=10;return S(i,t,r);case 10:a=o.sent;o.next=14;break;case 13:return o.abrupt("return",a);case 14:o.next=3;break;case 16:case"end":return o.stop()}}},e,this)}));return function(n,r){return e.apply(this,arguments)}}()),if:new y("if",function(e){var n=this;var r=function r(t){if(t){var i=S(e.cdr.car,n);if(typeof i==="undefined"){return}return i}else if(e.cdr.cdr.car instanceof d){var a=S(e.cdr.cdr.car,n);if(typeof a==="undefined"){return false}return a}else{return false}};var t=S(e.car,this);if(t instanceof Promise){return t.then(r)}else{return r(t)}}),"let*":A(true),let:A(false),begin:new y("begin",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(n,r){var t,i;return regeneratorRuntime.wrap(function e(a){while(1){switch(a.prev=a.next){case 0:t=this.get("list->array")(n);if(r){r=this}case 2:if(!true){a.next=13;break}if(!t.length){a.next=10;break}n=t.shift();a.next=7;return S(n,this,r);case 7:i=a.sent;a.next=11;break;case 10:return a.abrupt("return",i);case 11:a.next=2;break;case 13:case"end":return a.stop()}}},e,this)}));return function(n,r){return e.apply(this,arguments)}}()),timer:new y("timer",function(e){var n=this;return new Promise(function(r){setTimeout(function(){r(new g(S(e.cdr,n)))},e.car)})}),define:new y("define",function(e,n){var r=this;if(e.car instanceof d&&e.car.car instanceof h){var t=new d(new h("define"),new d(e.car.car,new d(new d(new h("lambda"),new d(e.car.cdr,e.cdr)))));return t}var i=e.cdr.car;if(i instanceof d){i=S(i,this,n)}if(e.car instanceof h){if(i instanceof Promise){return i.then(function(n){r.set(e.car,n)})}else{this.set(e.car,i)}}}),"set-obj":function e(n,r,t){n[r]=t},eval:function e(n,r){var t=this;if(n instanceof d){return S(n,this,r)}if(n instanceof Array){var i;n.forEach(function(e){i=S(e,t,r)});return i}},lambda:new y("lambda",function(e,n){var t=this;return function(){var i=(n?this:t).inherit("lambda");var a=e.car;var u=0;var o;if(a instanceof h||!a.isEmptyList()){for(var f=arguments.length,c=Array(f),s=0;s<f;s++){c[s]=arguments[s]}while(true){if(a.car!==p){if(a instanceof h){o=d.fromArray(c.slice(u));i.env[a.name]=o;break}else{if(typeof c[u]==="undefined"){o=p}else{o=c[u]}i.env[a.car.name]=o}}if(a.cdr===p){break}u++;a=a.cdr}}return S(e.cdr.car,i,n?i:r)}}),defmacro:new y("defmacro",function(e){if(e.car.car instanceof h){this.env[e.car.car.name]=new y(function(n){var r=new m({},this,"defmacro");var t=e.car.cdr;var i=n;while(true){if(t.car!==p&&i.car!==p){r.env[t.car.name]=i.car}if(t.cdr===p){break}i=i.cdr;t=t.cdr}return S(e.cdr.car,r)})}}),quote:new y("quote",function(e){return new g(e.car)}),quasiquote:new y("quasiquote",function(e){var n=this;var r=0;function t(e){if(e instanceof d){var i;if(h.is(e.car.car,"unquote-splicing")){i=S(e.car.cdr.car,n);if(!i instanceof d){throw new Error("Value of unquote-splicing need"+" to be pair")}if(e.cdr instanceof d){if(i instanceof d){i.cdr.append(t(e.cdr))}else{i=new d(i,t(e.cdr))}}return i}if(h.is(e.car,"unquote")){var a=e.cdr;var u=a;var o=u;var f=1;while(h.is(u.car.car,"unquote")){o=u;f++;u=u.car.cdr.car}if(f>r){r=f}if(o===u){if(e.cdr.cdr!==p){return new d(new b(e.cdr.car,f),e.cdr.cdr)}else{return new b(e.cdr.car,f)}}else if(o.cdr.cdr!==p){o.car.cdr=new d(new b(u,f),o.cdr===p?p:o.cdr.cdr)}else{o.car.cdr=new b(u,f)}return a.car}var c=e.car;if(c instanceof d){c=t(c)}var s=e.cdr;if(s instanceof d){s=t(s)}return new d(c,s)}return e}function i(e){if(e instanceof b){if(r===e.count){return S(e.value,n)}else{return new d(new h("unquote"),new d(i(e.value),p))}}if(e instanceof d){var t=e.car;if(t instanceof d||t instanceof b){t=i(t)}var a=e.cdr;if(a instanceof d||a instanceof b){a=i(a)}return new d(t,a)}return e}return new g(i(t(e.car)))}),clone:function e(n){return n.clone()},append:function e(n,r){return this.get("append!")(n.clone(),r)},"append!":function e(n,r){return n.append(r)},list:function e(){return d.fromArray([].slice.call(arguments))},concat:function e(){return[].join.call(arguments,"")},join:function e(n,r){return this.get("list->array")(r).join(n)},split:function e(n,r){return this.get("array->list")(n.split(r))},replace:function e(n,r,t){return n.replace(r,t)},match:function e(n,r){return this.get("array->list")(n.match(r))},search:function e(n,r){return n.search(r)},string:function e(n){if(typeof jQuery!=="undefined"&&n instanceof jQuery.fn.init){return"<#jQuery>"}if(n instanceof y){}if(n instanceof w){return n.value.toString()}if(typeof n==="undefined"){return"<#undefined>"}if(typeof n==="function"){return"<#function>"}if(n===p){return"nil"}if(n instanceof Array||n===null){return JSON.stringify(n)}if(n instanceof d){return n.toString()}if((typeof n==="undefined"?"undefined":_typeof(n))==="object"){var r=n.constructor.name;if(r!==""){return"<#"+r+">"}return"<#Object>"}if(typeof n!=="string"){return n.toString()}return n},env:function e(n){n=n||this;var t=Object.keys(n.env);var i;if(t.length){i=d.fromArray(t)}else{i=p}if(n.parent!==r){return this.get("env").call(this,n.parent).append(i)}return i},".":function e(n,r){var t=r instanceof h?r.name:r;var i=n[t];if(typeof i==="function"){return i.bind(n)}return i},type:function e(n){return typeof n==="undefined"?"undefined":_typeof(n)},instanceof:function e(n,r){return n instanceof r},read:function e(n){var r=this;if(typeof n==="string"){return s(o(n))}return this.get("stdin").read().then(function(e){return r.get("read").call(r,e)})},print:function e(){var n,r=this;for(var t=arguments.length,i=Array(t),a=0;a<t;a++){i[a]=arguments[a]}(n=this.get("stdout")).write.apply(n,_toConsumableArray(i.map(function(e){return r.get("string")(e)})))},flatten:function e(n){return n.flatten()},"array->list":function e(n){return d.fromArray(n)},"list->array":function e(n){if(n instanceof d&&n.isEmptyList()){return[]}var r=[];var t=n;while(true){if(t instanceof d){r.push(t.car);t=t.cdr}else{break}}return r},filter:function e(n,r){return d.fromArray(this.get("list->array")(r).filter(n))},apply:function e(n,r){var t=this.get("list->array")(r);return n.apply(null,t)},map:function e(n,r){var t=this.get("list->array")(r).map(n);if(t.length){return d.fromArray(t)}else{return p}},reduce:function e(n,t){var i=arguments.length>2&&arguments[2]!==r?arguments[2]:null;var a=this.get("list->array")(t);if(i===null){return a.slice(1).reduce(function(e,r){return n(e,r)},a[0])}else{return a.reduce(function(e,r){return n(e,r)},i)}},curry:function e(n){for(var r=arguments.length,t=Array(r>1?r-1:0),i=1;i<r;i++){t[i-1]=arguments[i]}var a=n.length;return function(){var e=t.slice();function r(){for(var t=arguments.length,i=Array(t),u=0;u<t;u++){i[u]=arguments[u]}e=e.concat(i);if(e.length>=a){return n.apply(this,e)}else{return r}}return r.apply(this,arguments)}},odd:function e(n){return w(n).isOdd()},even:function e(n){return w(n).isEvent()},range:function e(n){if(n instanceof w){n=n.valueOf()}return d.fromArray(new Array(n).fill(0).map(function(e,n){return w(n)}))},"*":function e(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++){r[t]=arguments[t]}if(r.length){return r.reduce(function(e,n){return w(e).mul(n)})}},"+":function e(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++){r[t]=arguments[t]}if(r.length){return r.reduce(function(e,n){if(w.isNumber(e)&&w.isNumber(n)){return w(e).add(n)}else if(typeof e==="string"){throw new Error("To concatenate strings use `concat`")}return e+n})}},"-":function e(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++){r[t]=arguments[t]}if(r.length===1){return w(r[0]).neg()}if(r.length){return r.reduce(function(e,n){return w(e).sub(n)})}},"/":function e(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++){r[t]=arguments[t]}if(r.length){return r.reduce(function(e,n){return w(e).div(n)})}},abs:function e(n){return w(n).abs()},sqrt:function e(n){if(n instanceof w){return Math.sqrt(n.valueOf())}return Math.sqrt(n)},"**":function e(n,r){return w(n).pow(r)},"1+":function e(n){return w(n).add(1)},"1-":function e(n){return w(n).sub(1)},"++":new y("++",function(e){var n=this.get(e.car);var r=w(n).add(1);this.set(e.car,r);return r}),"--":new y("--",function(e){var n=this.get(e.car);var r=w(n).sub(1);this.set(e.car,r);return r}),"%":function e(n,r){return w(n).mod(r)},"==":function e(n,r){return w(n).cmp(r)===0},">":function e(n,r){return w(n).cmp(r)===1},"<":function e(n,r){return w(n).cmp(r)===-1},"<=":function e(n,r){return[0,-1].includes(w(n).cmp(r))},">=":function e(n,r){[0,1].includes(w(n).cmp(r))},"eq?":function e(n,r){return n===r},or:new y("or",function(e){var n=this.get("list->array")(e);var r=this;return new Promise(function(e){var t;(function i(){function a(n){t=n;if(t){e(n)}i()}var u=n.shift();if(typeof u==="undefined"){if(t){e(t)}else{e(false)}}else{var o=S(u,r);if(o instanceof Promise){o.then(a)}else{a(o)}}})()})}),and:new y("and",function(e){var n=this.get("list->array")(e);var r=this;return new Promise(function(e){var t;(function i(){function a(n){t=n;if(!t){e(false)}i()}var u=n.shift();if(typeof u==="undefined"){if(t){e(t)}else{e(false)}}else{var o=S(u,r);if(o instanceof Promise){o.then(a)}else{a(o)}}})()})}),not:function e(n){if(n===p){return true}return!n},"->":function e(n,r){for(var t=arguments.length,i=Array(t>2?t-2:0),a=2;a<t;a++){i[a-2]=arguments[a]}return n[r].apply(n,i)}},r,"global");function q(e){if(e.length===1){return e[0]}else{var n=[];var r=q(e.slice(1));for(var t=0;t<r.length;t++){for(var i=0;i<e[0].length;i++){n.push(e[0][i]+r[t])}}return n}}function x(e,n,r){var t=[];for(var i=n;i<=r;++i){var a=[];for(var u=0;u<i;++u){a.push(e)}t=t.concat(q(a))}return t}x(["d","a"],2,5).forEach(function(e){var n=e.split("").reverse();k.set("c"+e+"r",function(e){return n.reduce(function(e,n){if(n==="a"){return e.car}else{return e.cdr}},e)})});if(typeof global!=="undefined"){k.set("global",global)}else if(typeof window!=="undefined"){k.set("window",window)}function S(e,n,r){if(r===true){n=r=n||k}else if(n===true){n=r=k}else{n=n||k}var t;if(typeof e==="undefined"){return}var i=e.car;var a=e.cdr;if(i instanceof d){t=S(i,n,r);if(t instanceof Promise){return t.then(function(t){return S(new d(t,e.cdr),n,r)})}else if(typeof t!=="function"){throw new Error(n.get("string")(t)+" is not a function")}}if(i instanceof h){t=n.get(i);if(t instanceof y){t=t.invoke(i,a,n,r);if(t instanceof g){return t.value}else if(t instanceof Promise){return t.then(function(e){if(e instanceof g){return e.value}return S(e,n,r)})}return S(t,n,r)}else if(typeof t!=="function"){throw new Error("Unknown function `"+i.name+"'")}}else if(typeof i==="function"){t=i}if(typeof t==="function"){var u=[];var o=a;while(true){if(o instanceof d){u.push(S(o.car,n,r));o=o.cdr}else{break}}var f=u.filter(function(e){return e instanceof Promise});if(f.length){return Promise.all(u).then(function(e){return t.apply(r||n,e)})}return t.apply(r||n,u)}else if(e instanceof h){t=n.get(e);if(t==="undefined"){throw new Error("Unbound variable `"+e.name+"'")}return t}else{return e}}function P(e,n,r){if(r===true){n=r=n||k}else if(n===true){n=r=k}else{n=n||k}var t=s(o(e));return new Promise(function(e,i){var a=[];(function u(){function o(e){a.push(e);u()}var f=t.shift();if(!f){e(a)}else{try{var c=S(f,n,r)}catch(e){return i(e)}if(c instanceof Promise){c.then(o).catch(i)}else{o(c)}}})()})}function j(e){var n=/[()]/;var r=o(e).filter(function(e){return e.match(n)});var t=r.filter(function(e){return e===")"});var i=r.filter(function(e){return e==="("});return t.length===i.length}d.unDry=function(e){return new d(e.car,e.cdr)};d.prototype.toDry=function(){return{value:{car:this.car,cdr:this.cdr}}};v.prototype.toDry=function(){return{value:null}};v.unDry=function(){return p};h.prototype.toDry=function(){return{value:{name:this.name}}};h.unDry=function(e){return new h(e.name)};function O(){var e="text-x/lips";if(window.document){Array.from(document.querySelectorAll("script")).forEach(function(n){var r=n.getAttribute("type");if(r===e){P(n.innerHTML)}else if(r==="text-x/lisp"){console.warn("Expecting "+e+" found "+r)}})}}function B(e){if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("load",e,false)}else if(window.attachEvent){window.attachEvent("onload",e)}else if(typeof window.onload==="function"){(function(n){window.onload=function(){e();n()}})(window.onload)}else{window.onload=e}}}B(function(){setTimeout(O,0)});return{version:"DEV",exec:P,parse:s,tokenize:o,evaluate:S,Environment:m,global_environment:k,balanced_parenthesis:j,Macro:y,Quote:g,Pair:d,nil:p,Symbol:h,LNumber:w}});