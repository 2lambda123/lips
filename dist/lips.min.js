/**@license
 * LIPS is Pretty Simple - version DEV
 *
 * Copyright (c) 2018 Jakub Jankiewicz <http://jcubic.pl/me>
 * Released under the MIT license
 *
 * build: Sat, 15 Sep 2018 09:56:03 +0000
 */
(function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}var t=e(function(e){function t(n){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=t=function e(t){return typeof t}}else{e.exports=t=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return t(n)}e.exports=t});var n=e(function(e){!function(n){var r=Object.prototype;var i=r.hasOwnProperty;var o;var a=typeof Symbol==="function"?Symbol:{};var u=a.iterator||"@@iterator";var f=a.asyncIterator||"@@asyncIterator";var c=a.toStringTag||"@@toStringTag";var s="object"==="object";var l=n.regeneratorRuntime;if(l){if(s){e.exports=l}return}l=n.regeneratorRuntime=s?e.exports:{};function h(e,t,n,r){var i=t&&t.prototype instanceof m?t:m;var o=Object.create(i.prototype);var a=new B(r||[]);o._invoke=O(e,n,a);return o}l.wrap=h;function v(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}var p="suspendedStart";var d="suspendedYield";var y="executing";var g="completed";var w={};function m(){}function b(){}function x(){}var E={};E[u]=function(){return this};var N=Object.getPrototypeOf;var A=N&&N(N(_([])));if(A&&A!==r&&i.call(A,u)){E=A}var j=x.prototype=m.prototype=Object.create(E);b.prototype=j.constructor=x;x.constructor=b;x[c]=b.displayName="GeneratorFunction";function k(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}l.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===b||(t.displayName||t.name)==="GeneratorFunction":false};l.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,x)}else{e.__proto__=x;if(!(c in e)){e[c]="GeneratorFunction"}}e.prototype=Object.create(j);return e};l.awrap=function(e){return{__await:e}};function L(e){function n(r,o,a,u){var f=v(e[r],e,o);if(f.type==="throw"){u(f.arg)}else{var c=f.arg;var s=c.value;if(s&&t(s)==="object"&&i.call(s,"__await")){return Promise.resolve(s.__await).then(function(e){n("next",e,a,u)},function(e){n("throw",e,a,u)})}return Promise.resolve(s).then(function(e){c.value=e;a(c)},function(e){return n("throw",e,a,u)})}}var r;function o(e,t){function i(){return new Promise(function(r,i){n(e,t,r,i)})}return r=r?r.then(i,i):i()}this._invoke=o}k(L.prototype);L.prototype[f]=function(){return this};l.AsyncIterator=L;l.async=function(e,t,n,r){var i=new L(h(e,t,n,r));return l.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function O(e,t,n){var r=p;return function i(o,a){if(r===y){throw new Error("Generator is already running")}if(r===g){if(o==="throw"){throw a}return R()}n.method=o;n.arg=a;while(true){var u=n.delegate;if(u){var f=S(u,n);if(f){if(f===w)continue;return f}}if(n.method==="next"){n.sent=n._sent=n.arg}else if(n.method==="throw"){if(r===p){r=g;throw n.arg}n.dispatchException(n.arg)}else if(n.method==="return"){n.abrupt("return",n.arg)}r=y;var c=v(e,t,n);if(c.type==="normal"){r=n.done?g:d;if(c.arg===w){continue}return{value:c.arg,done:n.done}}else if(c.type==="throw"){r=g;n.method="throw";n.arg=c.arg}}}}function S(e,t){var n=e.iterator[t.method];if(n===o){t.delegate=null;if(t.method==="throw"){if(e.iterator.return){t.method="return";t.arg=o;S(e,t);if(t.method==="throw"){return w}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var r=v(n,e.iterator,t.arg);if(r.type==="throw"){t.method="throw";t.arg=r.arg;t.delegate=null;return w}var i=r.arg;if(!i){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return w}if(i.done){t[e.resultName]=i.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=o}}else{return i}t.delegate=null;return w}k(j);j[c]="Generator";j[u]=function(){return this};j.toString=function(){return"[object Generator]"};function P(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function q(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(P,this);this.reset(true)}l.keys=function(e){var t=[];for(var n in e){t.push(n)}t.reverse();return function n(){while(t.length){var r=t.pop();if(r in e){n.value=r;n.done=false;return n}}n.done=true;return n}};function _(e){if(e){var t=e[u];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var n=-1,r=function t(){while(++n<e.length){if(i.call(e,n)){t.value=e[n];t.done=false;return t}}t.value=o;t.done=true;return t};return r.next=r}}return{next:R}}l.values=_;function R(){return{value:o,done:true}}B.prototype={constructor:B,reset:function e(t){this.prev=0;this.next=0;this.sent=this._sent=o;this.done=false;this.delegate=null;this.method="next";this.arg=o;this.tryEntries.forEach(q);if(!t){for(var n in this){if(n.charAt(0)==="t"&&i.call(this,n)&&!isNaN(+n.slice(1))){this[n]=o}}}},stop:function e(){this.done=true;var t=this.tryEntries[0];var n=t.completion;if(n.type==="throw"){throw n.arg}return this.rval},dispatchException:function e(t){if(this.done){throw t}var n=this;function r(e,r){f.type="throw";f.arg=t;n.next=e;if(r){n.method="next";n.arg=o}return!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a];var f=u.completion;if(u.tryLoc==="root"){return r("end")}if(u.tryLoc<=this.prev){var c=i.call(u,"catchLoc");var s=i.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc){return r(u.catchLoc,true)}else if(this.prev<u.finallyLoc){return r(u.finallyLoc)}}else if(c){if(this.prev<u.catchLoc){return r(u.catchLoc,true)}}else if(s){if(this.prev<u.finallyLoc){return r(u.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function e(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}if(a&&(t==="break"||t==="continue")&&a.tryLoc<=n&&n<=a.finallyLoc){a=null}var u=a?a.completion:{};u.type=t;u.arg=n;if(a){this.method="next";this.next=a.finallyLoc;return w}return this.complete(u)},complete:function e(t,n){if(t.type==="throw"){throw t.arg}if(t.type==="break"||t.type==="continue"){this.next=t.arg}else if(t.type==="return"){this.rval=this.arg=t.arg;this.method="return";this.next="end"}else if(t.type==="normal"&&n){this.next=n}return w},finish:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t){this.complete(r.completion,r.afterLoc);q(r);return w}}},catch:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if(i.type==="throw"){var o=i.arg;q(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function e(t,n,r){this.delegate={iterator:_(t),resultName:n,nextLoc:r};if(this.method==="next"){this.arg=o}return w}}}(function(){return this||(typeof self==="undefined"?"undefined":t(self))==="object"&&self}()||Function("return this")())});var r=function(){return this||(typeof self==="undefined"?"undefined":t(self))==="object"&&self}()||Function("return this")();var i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0;var o=i&&r.regeneratorRuntime;r.regeneratorRuntime=undefined;var a=n;if(i){r.regeneratorRuntime=o}else{try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=undefined}}var u=a;function f(e,t,n,r,i,o,a){try{var u=e[o](a);var f=u.value}catch(e){n(e);return}if(u.done){t(f)}else{Promise.resolve(f).then(r,i)}}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,u,"next",e)}function u(e){f(o,r,i,a,u,"throw",e)}a(undefined)})}}var s=c;function l(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++){n[t]=e[t]}return n}}var h=l;function v(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}var p=v;function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var y=d;function g(e){return h(e)||p(e)||y()}var w=g;
/**@license
 * LIPS is Pretty Simple - version DEV
 *
 * Copyright (c) 2018 Jakub Jankiewicz <http://jcubic.pl/me>
 * Released under the MIT license
 *
 * build: Sat, 15 Sep 2018 09:39:49 +0000
 */
/**@license
 * LIPS is Pretty Simple - version DEV
 *
 * Copyright (c) 2018 Jakub Jankiewicz <http://jcubic.pl/me>
 * Released under the MIT license
 *
 * build: Sat, 15 Sep 2018 09:39:49 +0000
 */
(function(e,n){if(typeof define==="function"&&define.amd){define(["bn.js"],function(t){return e.lips=n(e,t)})}else if((typeof module==="undefined"?"undefined":t(module))==="object"&&module.exports){module.exports=n(e,require("bn.js"))}else{e.lips=n(e,e.BN)}})(typeof window!=="undefined"?window:global,function(e,n,r){var i=/^\/((?:\\\/|[^/]|\[[^\]]*\/[^\]]*\])+)\/([gimy]*)$/;var o=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/;function a(e){function t(e){if(e.match(/^['"]/)){if(e==='""'||e==="''"){return""}var t=e[0];var n=new RegExp("((^|[^\\\\])(?:\\\\\\\\)*)"+t,"g");e=e.replace(n,"$1")}return JSON.parse('"'+e+'"')}var n=e.match(i);if(n){return new RegExp(n[1],n[2])}else if(e.match(/['"]/)){return t(e)}else if(e.match(/^-?[0-9]+$/)){return x(parseInt(e,10))}else if(e.match(o)){return x(parseFloat(e))}else if(e==="nil"){return g}else{return new d(e)}}var f=/("[^"\\]*(?:\\[\S\s][^"\\]*)*"|\/[^\/\\]*(?:\\[\S\s][^\/\\]*)*\/[gimy]*(?=\s|\(|\)|$)|;.*|\(|\)|'|\.|,@|,|`|[^(\s)]+)/gi;function c(e,t){if(t){return l(e)}else{return l(e).map(function(e){return e.token.trim()}).filter(function(e){return e&&!e.match(/^;/)})}}function l(e){var t=0;return e.split("\n").map(function(e,n){var r=0;t+=n===0?0:1;return e.split(f).filter(Boolean).map(function(e){var i={col:r,line:n,token:e,offset:t};r+=e.length;t+=e.length;return i})}).reduce(function(e,t){return e.concat(t)},[])}var h={"'":new d("quote"),"`":new d("quasiquote"),",":new d("unquote"),",@":new d("unquote-splicing")};function v(e){var t=[];var n=[];var r=null;var i=Object.keys(h);var o=i.map(function(e){return h[e].name});var u=0;var f=false;var c=[];var s=[];function l(){var e=t[t.length-1];if(e instanceof Array&&e[0]instanceof d&&o.includes(e[0].name)&&t.length>1){t.pop();if(t[t.length-1].length===1&&t[t.length-1][0]instanceof d){t[t.length-1].push(e)}else if(t[t.length-1].length===0){t[t.length-1]=e}else if(t[t.length-1]instanceof m){if(t[t.length-1].cdr instanceof m){t[t.length-1]=new m(t[t.length-1],m.fromArray(e))}else{t[t.length-1].cdr=m.fromArray(e)}}else{t[t.length-1].push(e)}}}e.forEach(function(e){var o=t[t.length-1];if(i.indexOf(e)!==-1){r=e;t.push([h[r]]);if(!r){s=[]}s.push(r)}else if(e==="("){f=true;u++;if(r){c.push(s);s=[]}t.push([]);r=null}else if(e==="."&&!f){t[t.length-1]=m.fromArray(o)}else if(e===")"){u--;if(!t.length){throw new Error("Unbalanced parenthesis 1")}if(t.length===1){n.push(t.pop())}else if(t.length>1){var v=t.pop();o=t[t.length-1];if(o instanceof Array){o.push(v)}else if(o instanceof m){o.append(m.fromArray(v))}if(c.length){s=c.pop();while(s.length){l();s.pop()}}else{l()}}if(u===0&&t.length){n.push(t.pop())}}else{f=false;var p=a(e);if(r){t[t.length-1][1]=p;p=t.pop();r=false}o=t[t.length-1];if(o instanceof m){var d=o;while(true){if(d.cdr===g){if(p instanceof Array){d.cdr=m.fromArray(p)}else{d.cdr=p}break}else{d=d.cdr}}}else if(!t.length){n.push(p)}else{o.push(p)}}});if(t.length){console.log({end:t.slice()});throw new Error("Unbalanced parenthesis 2")}return n.map(function(e){if(e instanceof Array){return m.fromArray(e)}return e})}function p(e,t){var n=Object.prototype.toString;var i="[object Array]";var o=[];var a=t&&e||e.slice();var u;if(!e.length){return o}u=a.pop();do{if(n.call(u)===i){a.push.apply(a,u)}else{o.push(u)}}while(a.length&&(u=a.pop())!==r);o.reverse();return o}function d(e){this.name=e}d.is=function(e,t){return e instanceof d&&typeof t==="string"&&e.name===t};d.prototype.toJSON=d.prototype.toString=function(){return this.name};function y(){}y.prototype.toString=function(){return"nil"};var g=new y;function m(e,t){this.car=e;this.cdr=t}m.prototype.flatten=function(){return m.fromArray(p(this.toArray()))};m.prototype.length=function(){var e=0;var t=this;while(true){if(t===g){break}e++;t=t.cdr}return e};m.prototype.clone=function(){var e=this.cdr;var t=this.car;if(t instanceof m){t=t.clone()}if(e instanceof m){e=this.cdr.clone()}return new m(t,e)};m.prototype.toArray=function(){if(this.cdr===g&&this.car===g){return[]}var e=[];if(this.car instanceof m){e.push(this.car.toArray())}else{e.push(this.car)}if(this.cdr instanceof m){e=e.concat(this.cdr.toArray())}return e};m.prototype.isEmptyList=function(){return typeof this.car==="undefined"&&this.cdr===g};m.fromArray=function(e){if(e instanceof m){return e}if(e.length&&!e instanceof Array){e=w(e)}if(e.length===0){return new m(r,g)}else{var t;if(e[0]instanceof Array){t=m.fromArray(e[0])}else{t=e[0]}if(e.length===1){return new m(t,g)}else{return new m(t,m.fromArray(e.slice(1)))}}};m.prototype.toObject=function(){var e=this;var t={};while(true){if(e instanceof m&&e.car instanceof m){var n=e.car;var r=n.car;if(r instanceof d){r=r.name}t[r]=n.cdr;e=e.cdr}else{break}}return t};m.fromPairs=function(e){return e.reduce(function(e,t){return new m(new m(new d(t[0]),t[1]),e)},g)};m.fromObject=function(e){var t=Object.keys(e).map(function(t){return[t,e[t]]});return m.fromPairs(t)};m.prototype.reduce=function(e){var t=this;var n=g;while(true){if(t!==g){n=e(n,t.car);t=t.cdr}else{break}}return n};m.prototype.reverse=function(){var e=this;var t=g;while(e!==g){var n=e.cdr;e.cdr=t;t=e;e=n}return t};m.prototype.transform=function(e){function t(n){if(n instanceof m){if(n.replace){delete n.replace;return n}var r=e(n.car);if(r instanceof m){r=t(r)}var i=e(n.cdr);if(i instanceof m){i=t(i)}return new m(r,i)}return n}return t(this)};m.prototype.toString=function(){var e=["("];if(this.car!==r){if(typeof this.car==="function"){e.push("<#function "+(this.car.name||"anonymous")+">")}else if(typeof this.car==="string"){e.push(JSON.stringify(this.car))}else if(typeof this.car!=="undefined"){e.push(this.car)}if(this.cdr instanceof m){e.push(" ");e.push(this.cdr.toString().replace(/^\(|\)$/g,""))}else if(typeof this.cdr!=="undefined"&&this.cdr!==g){if(typeof this.cdr==="string"){e=e.concat([" . ",JSON.stringify(this.cdr)])}else{e=e.concat([" . ",this.cdr])}}}e.push(")");return e.join("")};m.prototype.append=function(e){if(e instanceof Array){return this.append(m.fromArray(e))}var t=this;if(t.car===r){if(e instanceof m){this.car=e.car;this.cdr=e.cdr}else{return e}}else{while(true){if(t instanceof m&&t.cdr!==g){t=t.cdr}else{break}}t.cdr=e}return this};function b(e,t){this.name=e;this.fn=t}b.prototype.invoke=function(e,t,n,r){return this.fn.call(n,t,r,e)};b.prototype.toString=function(){return"#<Macro "+this.name+">"};function x(e){if(e instanceof x){return e}if(typeof this!=="undefined"&&this.constructor!==x||typeof this==="undefined"){return new x(e)}if(!x.isNumber(e)){throw new Error("You can't create LNumber from "+t(e))}if(e===null){e=0}if(x.isFloat(e)){this.value=e}else if(typeof BigInt!=="undefined"){if(typeof e!=="bigint"){this.value=BigInt(e)}else{this.value=e}}else if(typeof n!=="undefined"&&!(e instanceof n)){this.value=new n(e)}else{this.value=e}}x.isFloat=function e(t){return Number(t)===t&&t%1!==0};x.isNumber=function(e){return e instanceof x||x.isNative(e)||x.isBN(e)};x.isNative=function(e){return typeof e==="bigint"||typeof e==="number"};x.isBN=function(e){return typeof n!=="undefined"&&e instanceof n};x.prototype.toString=function(){return this.value.toString()};x.prototype.valueOf=function(){if(x.isNative(this.value)){return Number(this.value)}else if(x.isBN(this.value)){return this.value.toNumber()}};x.prototype.coerce=function(e){if(e===null){e=0}var t;if(e instanceof x){t=e.value}else{t=e}if(x.isFloat(t)){}else if(typeof this.value==="bigint"&&typeof t!=="bigint"){t=BigInt(t)}else if(typeof n!=="undefined"&&this.value instanceof n&&!t instanceof n){t=new n(t)}return x(t)};x.prototype.add=function(e){e=this.coerce(e);if(x.isNative(e.value)){e.value=this.value+e.value}else if(x.isBN(this.value)){e.value.iadd(this.value)}return e};x.prototype.sub=function(e){e=this.coerce(e);if(x.isNative(e.value)){e.value=this.value-e.value}else if(x.isBN(this.value)){e.value.isub(this.value)}return e};x.prototype.mul=function(e){e=this.coerce(e);if(x.isNative(e.value)){e.value=this.value*e.value}else if(x.isBN(this.value)){e.value.imul(this.value)}return e};x.prototype.div=function(e){e=this.coerce(e);if(x.isNative(e.value)){e.value=this.value/e.value}else if(x.isBN(this.value)){e.value.idiv(this.value)}return e};x.prototype.mod=function(e){e=this.coerce(e);if(x.isNative(e.value)){e.value=this.value%e.value}else if(x.isBN(this.value)){e.value.imod(this.value)}return e};x.prototype.sqrt=function(){var e;if(x.isNative(this.value)){e=Math.sqrt(this.value)}else if(x.isBN(this.value)){e=this.value.sqrt()}return new x(e)};x.prototype.pow=function(e){e=this.coerce(e);if(x.isNative(this.value)){try{var t=new Function("a,b","return a**b;");e.value=t(this.value,e.value)}catch(e){throw new Error("Power operator not supported")}}else if(x.isBN(this.value)){e.value=this.value.pow(e.value)}else{e.value=Math.pow(this.value,e.value)}return e};x.prototype.neg=function(){var e=this.value;if(x.isNative(e)){e=-e}else if(x.isBN(e)){e=e.neg()}return new x(e)};x.prototype.abs=function(){var e=this.value;if(x.isNative(this.value)){if(e<0){e=-e}}else if(x.isBN(e)){e.iabs()}return new x(e)};x.prototype.isOdd=function(){if(x.isNative(this.value)){return this.value%2===1}else if(x.isBN(this.value)){return this.value.isOdd()}};x.prototype.isEven=function(){return!this.isOdd()};x.prototype.cmp=function(e){e=this.coerce(e);if(x.isNative(this.value)){if(this.value<e.value){return-1}else if(this.value===e.value){return 0}else{return 1}}else if(x.isBN(this.value)){return this.value.cmp(e.value)}};function E(e,t,n){this.env=e;this.parent=t;this.name=n}E.prototype.inherit=function(e,t){if(typeof e==="string"){t=e;e={}}if(!t){t="child of "+(this.name||"unknown")}return new E(e||{},this,t)};E.prototype.get=function(n){var r;if(n instanceof d){if(typeof this.env[n.name]!=="undefined"){r=this.env[n.name]}}else if(typeof n==="string"){if(typeof this.env[n]!=="undefined"){r=this.env[n]}}if(typeof r!=="undefined"){if(x.isNumber(r)){return x(r)}return r}if(this.parent instanceof E){return this.parent.get(n)}else{var i;if(n instanceof d){i=n.name}else if(typeof n==="string"){i=n}if(i){var o=t(e[i]);if(o==="function"){return e[i].bind(e)}else if(o!=="undefined"){return e[i]}}}};E.prototype.set=function(e,t){if(x.isNumber(t)){t=x(t)}if(e instanceof d){e=e.name}this.env[e]=t};function N(e){this.value=e}function A(e,t){this.value=e;this.count=t}A.prototype.toString=function(){return"<#unquote["+this.count+"] "+this.value+">"};function j(e){var t="let"+(e?"*":"");return new b(t,function(t,n){var r=this;var i=this.get("list->array")(t.car);var o=this.inherit("let");return new Promise(function(a){var u=[];var f=0;(function c(){var s=i[f++];function l(e){if(e instanceof Promise){u.push(e);return e.then(l)}else{o.set(s.car,e)}}if(!s){var h=new m(new d("begin"),t.cdr);q(h,o,n?o:n).then(function(e){a(new N(e))})}else{var v=q(s.cdr.car,e?o:r,n);var p=l(v);if(p instanceof Promise){p.then(function(){Promise.all(u).then(c)})}else{c()}}})()})})}var k=function(){var e=0;return function(){e++;return new d("#"+e)}}();function L(e){var t=arguments.length>1&&arguments[1]!==r?arguments[1]:"GET";var n=arguments.length>2&&arguments[2]!==r?arguments[2]:{};var i=arguments.length>3&&arguments[3]!==r?arguments[3]:null;var o=new XMLHttpRequest;o.open(t,e,true);Object.keys(n).forEach(function(e){o.setRequestHeader(e,n[e])});return new Promise(function(e){o.onreadystatechange=function(){if(o.readyState===4&&o.status===200){e(o.responseText)}};if(i!==null){o.send(i)}else{o.send()}})}var O=new E({nil:g,true:true,false:false,stdout:{write:function e(){var t;(t=console).log.apply(t,arguments)}},stdin:{read:function e(){return new Promise(function(e){e(prompt(""))})}},test:function e(){return Promise.resolve(r)},cons:function e(t,n){return new m(t,n)},car:function e(t){if(t instanceof m){return t.car}else{throw new Error("argument to car need to be a list")}},cdr:function e(t){if(t instanceof m){return t.cdr}else{throw new Error("argument to cdr need to be a list")}},set:new b("set",function(e,t){var n;if(e.cdr.car instanceof m){if(t){t=this}n=q(e.cdr.car,this,t)}else{n=e.cdr.car}this.set(e.car,n)}),"set-car":function e(t,n){t.car=n},"set-cdr":function e(t,n){t.cdr=n},assoc:function e(t,n){var r=t;var i=n instanceof d?n.name:n;while(true){var o=r.car.car;if(o instanceof d&&o.name===i||o.name===i){return r.car}else{r=r.cdr}}},gensym:k,load:function e(t){var n=this;L(t).then(function(e){n.get("eval")(n.get("read")(e))})},while:new b("while",function(){var e=s(u.mark(function e(t,n){var r,i,o,a;return u.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:r=this;i=new m(new d("begin"),t.cdr);if(n){n=r}case 3:u.next=6;return q(t.car,r,n);case 6:a=u.sent;if(!a){u.next=13;break}u.next=10;return q(i,r,n);case 10:o=u.sent;u.next=14;break;case 13:return u.abrupt("return",o);case 14:u.next=3;break;case 16:case"end":return u.stop()}}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()),if:new b("if",function(e){var t=this;var n=function n(r){if(r){var i=q(e.cdr.car,t);if(typeof i==="undefined"){return}return i}else if(e.cdr.cdr.car instanceof m){var o=q(e.cdr.cdr.car,t);if(typeof o==="undefined"){return false}return o}else{return false}};var r=q(e.car,this);if(r instanceof Promise){return r.then(n)}else{return n(r)}}),"let*":j(true),let:j(false),begin:new b("begin",function(){var e=s(u.mark(function e(t,n){var r,i;return u.wrap(function e(o){while(1){switch(o.prev=o.next){case 0:r=this.get("list->array")(t);if(n){n=this}case 2:if(!r.length){o.next=10;break}t=r.shift();o.next=7;return q(t,this,n);case 7:i=o.sent;o.next=11;break;case 10:return o.abrupt("return",i);case 11:o.next=2;break;case 13:case"end":return o.stop()}}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()),timer:new b("timer",function(e){var t=this;return new Promise(function(n){setTimeout(function(){n(new N(q(e.cdr,t)))},e.car)})}),define:new b("define",function(e,t){var n=this;if(e.car instanceof m&&e.car.car instanceof d){var r=new m(new d("define"),new m(e.car.car,new m(new m(new d("lambda"),new m(e.car.cdr,e.cdr)))));return r}var i=e.cdr.car;if(i instanceof m){i=q(i,this,t)}if(e.car instanceof d){if(i instanceof Promise){return i.then(function(t){n.set(e.car,t)})}else{this.set(e.car,i)}}}),"set-obj":function e(t,n,r){t[n]=r},eval:function e(t,n){var r=this;if(t instanceof m){return q(t,this,n)}if(t instanceof Array){var i;t.forEach(function(e){i=q(e,r,n)});return i}},lambda:new b("lambda",function(e,t){var n=this;return function(){var i=(t?this:n).inherit("lambda");var o=e.car;var a=0;var u;if(o instanceof d||!o.isEmptyList()){for(var f=arguments.length,c=new Array(f),s=0;s<f;s++){c[s]=arguments[s]}while(true){if(o.car!==g){if(o instanceof d){u=m.fromArray(c.slice(a));i.env[o.name]=u;break}else{if(typeof c[a]==="undefined"){u=g}else{u=c[a]}i.env[o.car.name]=u}}if(o.cdr===g){break}a++;o=o.cdr}}return q(e.cdr.car,i,t?i:r)}}),defmacro:new b("defmacro",function(e){if(e.car.car instanceof d){this.env[e.car.car.name]=new b(function(t){var n=new E({},this,"defmacro");var r=e.car.cdr;var i=t;while(true){if(r.car!==g&&i.car!==g){n.env[r.car.name]=i.car}if(r.cdr===g){break}i=i.cdr;r=r.cdr}return q(e.cdr.car,n)})}}),quote:new b("quote",function(e){return new N(e.car)}),quasiquote:new b("quasiquote",function(e){var t=this;var n=0;function r(e){if(e instanceof m){var i;if(d.is(e.car.car,"unquote-splicing")){i=q(e.car.cdr.car,t);if(!i instanceof m){throw new Error("Value of unquote-splicing need"+" to be pair")}if(e.cdr instanceof m){if(i instanceof m){i.cdr.append(r(e.cdr))}else{i=new m(i,r(e.cdr))}}return i}if(d.is(e.car,"unquote")){var o=e.cdr;var a=o;var u=a;var f=1;while(d.is(a.car.car,"unquote")){u=a;f++;a=a.car.cdr.car}if(f>n){n=f}if(u===a){if(e.cdr.cdr!==g){return new m(new A(e.cdr.car,f),e.cdr.cdr)}else{return new A(e.cdr.car,f)}}else if(u.cdr.cdr!==g){u.car.cdr=new m(new A(a,f),u.cdr===g?g:u.cdr.cdr)}else{u.car.cdr=new A(a,f)}return o.car}var c=e.car;if(c instanceof m){c=r(c)}var s=e.cdr;if(s instanceof m){s=r(s)}return new m(c,s)}return e}function i(e){if(e instanceof A){if(n===e.count){return q(e.value,t)}else{return new m(new d("unquote"),new m(i(e.value),g))}}if(e instanceof m){var r=e.car;if(r instanceof m||r instanceof A){r=i(r)}var o=e.cdr;if(o instanceof m||o instanceof A){o=i(o)}return new m(r,o)}return e}return new N(i(r(e.car)))}),clone:function e(t){return t.clone()},append:function e(t,n){return this.get("append!")(t.clone(),n)},"append!":function e(t,n){return t.append(n)},list:function e(){return m.fromArray([].slice.call(arguments))},concat:function e(){return[].join.call(arguments,"")},join:function e(t,n){return this.get("list->array")(n).join(t)},split:function e(t,n){return this.get("array->list")(t.split(n))},replace:function e(t,n,r){return t.replace(n,r)},match:function e(t,n){return this.get("array->list")(t.match(n))},search:function e(t,n){return t.search(n)},string:function e(n){if(typeof jQuery!=="undefined"&&n instanceof jQuery.fn.init){return"<#jQuery>"}if(n instanceof x){return n.value.toString()}if(typeof n==="undefined"){return"<#undefined>"}if(typeof n==="function"){return"<#function>"}if(n===g){return"nil"}if(n instanceof Array||n===null){return JSON.stringify(n)}if(n instanceof m){return n.toString()}if(t(n)==="object"){var r=n.constructor.name;if(r!==""){return"<#"+r+">"}return"<#Object>"}if(typeof n!=="string"){return n.toString()}return n},env:function e(t){t=t||this;var n=Object.keys(t.env);var i;if(n.length){i=m.fromArray(n)}else{i=g}if(t.parent!==r){return this.get("env").call(this,t.parent).append(i)}return i},".":function e(t,n){var r=n instanceof d?n.name:n;var i=t[r];if(typeof i==="function"){return i.bind(t)}return i},type:function e(n){return t(n)},instanceof:function e(t,n){return t instanceof n},read:function e(t){var n=this;if(typeof t==="string"){return v(c(t))}return this.get("stdin").read().then(function(e){return n.get("read").call(n,e)})},print:function e(){var t,n=this;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++){i[o]=arguments[o]}(t=this.get("stdout")).write.apply(t,w(i.map(function(e){return n.get("string")(e)})))},flatten:function e(t){return t.flatten()},"array->list":function e(t){return m.fromArray(t)},"list->array":function e(t){if(t instanceof m&&t.isEmptyList()){return[]}var n=[];var r=t;while(true){if(r instanceof m){n.push(r.car);r=r.cdr}else{break}}return n},filter:function e(t,n){return m.fromArray(this.get("list->array")(n).filter(t))},apply:function e(t,n){var r=this.get("list->array")(n);return t.apply(null,r)},map:function e(t,n){var r=this.get("list->array")(n).map(t);if(r.length){return m.fromArray(r)}else{return g}},reduce:function e(t,n){var i=arguments.length>2&&arguments[2]!==r?arguments[2]:null;var o=this.get("list->array")(n);if(i===null){return o.slice(1).reduce(function(e,n){return t(e,n)},o[0])}else{return o.reduce(function(e,n){return t(e,n)},i)}},curry:function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++){r[i-1]=arguments[i]}var o=t.length;return function(){var e=r.slice();function n(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++){i[a]=arguments[a]}e=e.concat(i);if(e.length>=o){return t.apply(this,e)}else{return n}}return n.apply(this,arguments)}},odd:function e(t){return x(t).isOdd()},even:function e(t){return x(t).isEvent()},range:function e(t){if(t instanceof x){t=t.valueOf()}return m.fromArray(new Array(t).fill(0).map(function(e,t){return x(t)}))},"*":function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}if(n.length){return n.reduce(function(e,t){return x(e).mul(t)})}},"+":function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}if(n.length){return n.reduce(function(e,t){if(x.isNumber(e)&&x.isNumber(t)){return x(e).add(t)}else if(typeof e==="string"){throw new Error("To concatenate strings use `concat`")}return e+t})}},"-":function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}if(n.length===1){return x(n[0]).neg()}if(n.length){return n.reduce(function(e,t){return x(e).sub(t)})}},"/":function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}if(n.length){return n.reduce(function(e,t){return x(e).div(t)})}},abs:function e(t){return x(t).abs()},sqrt:function e(t){if(t instanceof x){return Math.sqrt(t.valueOf())}return Math.sqrt(t)},"**":function e(t,n){return x(t).pow(n)},"1+":function e(t){return x(t).add(1)},"1-":function e(t){return x(t).sub(1)},"++":new b("++",function(e){var t=this.get(e.car);var n=x(t).add(1);this.set(e.car,n);return n}),"--":new b("--",function(e){var t=this.get(e.car);var n=x(t).sub(1);this.set(e.car,n);return n}),"%":function e(t,n){return x(t).mod(n)},"==":function e(t,n){return x(t).cmp(n)===0},">":function e(t,n){return x(t).cmp(n)===1},"<":function e(t,n){return x(t).cmp(n)===-1},"<=":function e(t,n){return[0,-1].includes(x(t).cmp(n))},">=":function e(t,n){[0,1].includes(x(t).cmp(n))},"eq?":function e(t,n){return t===n},or:new b("or",function(e){var t=this.get("list->array")(e);var n=this;return new Promise(function(e){var r;(function i(){function o(t){r=t;if(r){e(t)}i()}var a=t.shift();if(typeof a==="undefined"){if(r){e(r)}else{e(false)}}else{var u=q(a,n);if(u instanceof Promise){u.then(o)}else{o(u)}}})()})}),and:new b("and",function(e){var t=this.get("list->array")(e);var n=this;return new Promise(function(e){var r;(function i(){function o(t){r=t;if(!r){e(false)}i()}var a=t.shift();if(typeof a==="undefined"){if(r){e(r)}else{e(false)}}else{var u=q(a,n);if(u instanceof Promise){u.then(o)}else{o(u)}}})()})}),not:function e(t){if(t===g){return true}return!t},"->":function e(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++){i[o-2]=arguments[o]}return t[n].apply(t,i)}},r,"global");function S(e){if(e.length===1){return e[0]}else{var t=[];var n=S(e.slice(1));for(var r=0;r<n.length;r++){for(var i=0;i<e[0].length;i++){t.push(e[0][i]+n[r])}}return t}}function P(e,t,n){var r=[];for(var i=t;i<=n;++i){var o=[];for(var a=0;a<i;++a){o.push(e)}r=r.concat(S(o))}return r}P(["d","a"],2,5).forEach(function(e){var t=e.split("").reverse();O.set("c"+e+"r",function(e){return t.reduce(function(e,t){if(t==="a"){return e.car}else{return e.cdr}},e)})});if(typeof global!=="undefined"){O.set("global",global)}else if(typeof window!=="undefined"){O.set("window",window)}function q(e,t,n){if(n===true){t=n=t||O}else if(t===true){t=n=O}else{t=t||O}var r;if(typeof e==="undefined"){return}var i=e.car;var o=e.cdr;if(i instanceof m){r=q(i,t,n);if(r instanceof Promise){return r.then(function(r){return q(new m(r,e.cdr),t,n)})}else if(typeof r!=="function"){throw new Error(t.get("string")(r)+" is not a function")}}if(i instanceof d){r=t.get(i);if(r instanceof b){r=r.invoke(i,o,t,n);if(r instanceof N){return r.value}else if(r instanceof Promise){return r.then(function(e){if(e instanceof N){return e.value}return q(e,t,n)})}return q(r,t,n)}else if(typeof r!=="function"){throw new Error("Unknown function `"+i.name+"'")}}else if(typeof i==="function"){r=i}if(typeof r==="function"){var a=[];var u=o;while(true){if(u instanceof m){a.push(q(u.car,t,n));u=u.cdr}else{break}}var f=a.filter(function(e){return e instanceof Promise});if(f.length){return Promise.all(a).then(function(e){return r.apply(n||t,e)})}return r.apply(n||t,a)}else if(e instanceof d){r=t.get(e);if(r==="undefined"){throw new Error("Unbound variable `"+e.name+"'")}return r}else{return e}}function B(e,t,n){if(n===true){t=n=t||O}else if(t===true){t=n=O}else{t=t||O}var r=v(c(e));return new Promise(function(e,i){var o=[];(function a(){function u(e){o.push(e);a()}var f=r.shift();if(!f){e(o)}else{try{var c=q(f,t,n)}catch(e){return i(e)}if(c instanceof Promise){c.then(u).catch(i)}else{u(c)}}})()})}function _(e){var t=/[()]/;var n=c(e).filter(function(e){return e.match(t)});var r=n.filter(function(e){return e===")"});var i=n.filter(function(e){return e==="("});return r.length===i.length}m.unDry=function(e){return new m(e.car,e.cdr)};m.prototype.toDry=function(){return{value:{car:this.car,cdr:this.cdr}}};y.prototype.toDry=function(){return{value:null}};y.unDry=function(){return g};d.prototype.toDry=function(){return{value:{name:this.name}}};d.unDry=function(e){return new d(e.name)};function R(){var e="text-x/lips";if(window.document){Array.from(document.querySelectorAll("script")).forEach(function(t){var n=t.getAttribute("type");if(n===e){B(t.innerHTML)}else if(n==="text-x/lisp"){console.warn("Expecting "+e+" found "+n)}})}}function F(e){if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("load",e,false)}else if(window.attachEvent){window.attachEvent("onload",e)}else if(typeof window.onload==="function"){(function(t){window.onload=function(){e();t()}})(window.onload)}else{window.onload=e}}}F(function(){setTimeout(R,0)});return{version:"DEV",exec:B,parse:v,tokenize:c,evaluate:q,Environment:E,global_environment:O,balanced_parenthesis:_,Macro:b,Quote:N,Pair:m,nil:g,Symbol:d,LNumber:x}})})();