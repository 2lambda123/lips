<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>LIPS Is Pretty Simple</title>
    <meta name="Description" content=""/>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png"/>
    <link rel="manifest" href="favicon/site.webmanifest"/>
    <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5"/>
    <link rel="shortcut icon" href="favicon/favicon.ico"/>
    <meta name="msapplication-TileColor" content="#ff6600"/>
    <meta name="msapplication-config" content="favicon/browserconfig.xml"/>
    <meta name="theme-color" content="#ffffff"/>
    <!--[if IE]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="style.css" rel="stylesheet"/>
    <link href="https://unpkg.com/jquery.terminal/css/jquery.terminal.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Crimson+Text|Play" rel="stylesheet"/>
</head>
<body>
  <header class="main">
    <a href="/lips/">
      <img src="/lips/logo.svg"/>
      <h1>
        LIPS Is Pretty Simple
      </h1>
    </a>
    <nav>
      <ul>
        <li><a href="/lips/#demo">Demo</a></li>
        <li><a href="/lips/docs.html">Docs</a></li>
        <li><a href="https://github.com/jcubic/lips/wiki/Getting-Started">Getting Started</a></li>
        <li><a href="https://github.com/jcubic/lips">github</a></li>
        <li><a href="/lips/examples/index.html">Hyper App</a></li>
        <li><a href="/lips/todo.html#/all">TODO app</a></li>
      </ul>
    </nav>
  </header>
  <section>
    <h3>Variables and functions</h3>

    <pre><code class="language-scheme">
(define x 10)
(define square (lambda (x) (* x x)))
(define (square x) (* x x))
    </code></pre>

    <h3>Lisp Macros</h3>

    <pre><code class="language-scheme">
(define-macro (foo x) `(1 2 ,@(car x) 3 4))
    </code></pre>

    <h3>BigInt</h3>

    <p>lips have no problems in evaluating factorial of thousand, and it's fast.</p>

    <pre><code class="language-scheme">
(define (! n) (reduce * (map 1+ (range n))))

(print (! 1000))
    </code></pre>

    <h3>List operations</h3>

    <pre><code class="language-scheme">
(cons 1 2)
(cons 1 (cons 2 nil))
(list 1 2 3 4)
'(1 2 3 4)

(let ((lst '(1 2 (3 4 5 6))))
   (print (car lst))
   (print (cadaddr lst)))
    </code></pre>

    <p>all functions that match this regex `c[ad]{1,5}r` are defined.</p>

    <h3>ALists</h3>

    <pre><code class="language-scheme">
(let ((l '((foo . "lorem") (bar "ipsum"))))
   (set-cdr! (assoc l 'foo) "hello")
   (set-cdr! (assoc l 'bar) "world")
   (print l))
    </code></pre>

    <h3>Flow constructs</h3>

    <pre><code class="language-scheme">
(let ((x 5))
    (while (> (-- x) 0) (print x)))
    </code></pre>

    <p>Operator <code>==</code> work as == in javascript but it should only be used on number or
      values that can be converted to numbers like string "10".</p>
    <p>To compare strings or any values use <code>eq?</code></p>

    <pre><code class="language-scheme">
(if (== "10" 10)
    (print "newer printed"))

(if (eq? "foo" "bar")
    (print "equal")
    (print "not equal"))

(let ((x 10))
  (if (and (> x 1) (< x 20))
      (begin
         (print "this is x > 1")
         (print "and x < 20"))))
    </code></pre>

    <h3>Eval</h3>

    <pre><code class="language-scheme">
(eval (read "(print \"hello\")"))
    </code></pre>

    <h3>Apply</h3>

    <p>Apply function the same as the one from javascript invoke a function with arguments taken from list</p>

    <pre><code class="language-scheme">
(let ((strings '("foo" "bar" "baz")))
   (print (apply concat strings)))
    </code></pre>

    <h3>Async code</h3>

    <pre><code class="language-scheme">
(eval (read))
    </code></pre>

    <p>
      then type S-Expression like <code>(print 10)</code>. If function return Promise
      the execution is paused and restored when Promise is resolved
    </p>


    <h3>Access JavaScript functions and objects</h3>

    <pre><code class="language-scheme">
((. window "alert") "hello")
((. console "log") "hello")
    </code></pre>

    <p>
      If object is not found in environment, then window object is tested for
      presense of the element.
    </p>

    <p>You can execute jQuery functions</p>

    <pre><code class="language-scheme">
(let* ((term ($ ".terminal")))
  ((.  term "css") "background" "red"))
    </code></pre>

    <p>function <code>$</code> is available because it's in window object.</p>

    <p>or operate on strings</p>

    <pre><code class="language-scheme">
((. "foo bar baz" "replace") /^[a-z]+/g "baz")

(let ((match (. "foo bar baz" "match")))
    (array->list (match /([a-z]+)/g)))
    </code></pre>

    <h3>String operations</h3>

    <pre><code class="language-scheme">
;; todo
    </code></pre>

    <h3>Mapping, filtering and reducing</h3>

    <pre><code class="language-scheme">
(map car (list
            (cons "a" 2)
            (cons "b" 3)))

(filter odd (list 1 2 3 4 5))

(filter (lambda (x)
          (== (% x 2) 0))
    (list 1 2 3 4 5))

(define (reverse list)
    (reduce (lambda (list x) (cons x list)) list nil))

(reverse '(1 2 3 4))

(define (sum . list) (reduce (lambda (a b) (+ a b)) list))
;; or
(define (sum . list) (reduce + list))

(print (sum 1 2 3 4 5))
    </code></pre>

    <h3>Auto resolving promises</h3>

    <pre><code class="language-scheme">
(let* ((res (fetch "https://terminal.jcubic.pl"))
       (text ((. res "text"))))
   (. ((. text "match") "&lt;title&gt;([^<]+)") 1))
    </code></pre>

    <h3>Currying</h3>

    <pre><code class="language-scheme">
(define (add a b) (+ a b))
(define add10 (curry add 10))
(print (add10 20))
    </code></pre>

    <h3>Working with arrays</h3>

    <p>
      You can modify array with <code>set!</code> function and to get the value of the
      array you can use <code>.</code> dot function.
    </p>

    <pre><code class="language-scheme">
(let ((arr (list->array '(1 2 3 4))))
   (set! (. x 1) 10)
   (print (array->list arr)))

(let* ((div ((. document "querySelectorAll") ".terminal .cmd-prompt"))
       (len (. div "length"))
       (i 0))
    (while (< i len)
       (print (. (. div i) "innerHTML"))
       (++ i)))
    </code></pre>

    <p>this equivalent of JavaScript code:</p>

    <pre><code class="language-javascript">
var div = document.querySelectorAll(".terminal .cmd-prompt");
var len = div.length;
var i = 0;
while (i < len) {
   console.log(div[i].innerHTML);
   ++i;
}
    </code></pre>

    <h3>Stdin and stdout</h3>

    <p>If you're using <strong><code>print</code></strong> function to display values or using
      <strong><code>read</code></strong> to get values from users, you can provide your own
      handlers in environment, jQuery Terminal based implementation look like this:</p>
    <p>By default stdout prints to console and stdin use browser <strong><code>prompt</code></strong> function.</p>

    <pre><code class="language-javascript">
var env = lips.env.inherit('name', {
    stdout: {
        write: function(...args) {
            args.forEach((arg) => {
                term.echo(arg, {keepWords: true});
            });
        }
    },
    stdin: {
        read: function() {
            return new Promise(function(resolve) {
                term.read('', function(command) {
                    resolve(command);
                });
            });
        }
    }
});
    </code></pre>

    <h3>Math and boolean operators (functions and macros)</h3>

    <pre>< > => <= 1+ 1- ++ -- + - * / % and or not</pre>
    <h3>Bit operation</h3>

    <pre>| &amp; ~ &lt;&lt; &gt;&gt;</pre>


    <h3>Extending LIPS</h3>

    <p>to create new function from JavaScript you can use:</p>

    <pre><code class="language-javascript">
env.set('greeter', function(user) {
   return "hello " + user;
});
    </code></pre>

    <p>then you can use it in LIPS:</p>

    <pre><code class="langauge-scheme">
(greeter "john")
    </code></pre>

    <p>
      To define a macro in javascript you can use Macro constructor that accept
      single function argument, that should return lisp code (instance of Pair).
    </p>

    <pre><code class="language-javascript">
var {Macro, Pair, Symbol, nil} = lips;

env.set('quote-car', new Macro('quote-car', function(code) {
    return Pair.fromArray([new Symbol('quote'), code.car.car]);
}));
    </code></pre>

    <p>and you can execute this macro in LIPS:</p>
    <pre><code class="language-scheme">
(quote-car (foo bar baz))
    </code></pre>
    <p>it will return first symbol and not execute it as function foo.</p>

    <p>you can also use eval here to execute code</p>
    <pre><code class="language-javascript">
env.set('async', new Macro('async', function(code, {dynamic_scope, error}) {
    var args = {error, env: this};
    if (dynamic_scope) {
        args.dynamic_scope = this;
    }
    return new Promise(function(resolve) {
        setTimeout(function() {
            resolve(evaluate(code.car, args));
        }, 0);
    });
}));
    </code></pre>

    <p>This function will invoke code in next iteration of event loop</p>
    <p>
      if you want to create macro like quasiquote, the returned code need to be wrapped with
      function quote
    </p>
    <p>
      When creating macros in JavaScript you can use helper <code>Pair.fromArray()</code>
      and <code>code.toArray()</code>.
    </p>
  </section>
  <footer>
    <p>Copyright (c) 2018-2019 <a href="https://jcubic.pl/me">Jakub T. Jankiewicz</a></p>
  </footer>
  <script src="https://unpkg.com/prismjs/prism.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-scheme.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-javascript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-markup.min.js"></script>
  <link href="https://unpkg.com/prismjs/themes/prism-coy.css" rel="stylesheet"/>
</body>
</html>
